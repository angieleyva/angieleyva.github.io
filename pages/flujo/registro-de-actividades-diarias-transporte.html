<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de actividades diarias</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="./../../styles/theme.css">
  <link rel="stylesheet" href="./../../styles/index.css">

  <link rel="stylesheet" href="../../styles/pages/flujo/registro-de-actividades-diarias-transporte.css" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

</head>

<body>
  <header class="w-100 d-flex justify-content-center position-sticky top-0" style="background: var(--white); z-index: 1000;">
    <nav class="container-header navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand fs-2 fw-bold text-green" href="/">EcoVibe</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-between" id="navbarNavDropdown">
          <ul class="navbar-nav gap-0 gap-lg-4">
            <li class="nav-item d-flex align-items-center gap-2">
              <div class="dropdown">
                <span class="dropdown-toggle nav-link" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Servicios
                </span>
                <ul class="dropdown-menu mt-2 shadow-lg dropdown-menu--header__services">
                  <li id="calculatorService"><a class="dropdown-item" href="#" style="white-space: pre-wrap;">Calculadora de huella de carbono</a></li>
                  <li id="activeService"><a class="dropdown-item" href="/pages/flujo/registro-de-actividades-diarias-transporte.html" style="white-space: pre-wrap;">Registro de actividades diarias</a></li>
                  <li><a class="dropdown-item" href="/pages/tienda.html" style="white-space: pre-wrap;">Tienda</a></li>
                </ul>
              </div>
            </li>
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="#">Rankings</a>
            </li>
            <li class="nav-item position-relative d-flex align-items-center form-control--header__search">
              <div class="position-absolute">
                <i class="ms-2 fa-solid fa-magnifying-glass"></i>
              </div>
              <input class="form-control form-control-sm" style="padding-left: 32px;" type="search" placeholder="Buscar" aria-label="Search">
            </li>
          </ul>
          <div class="d-flex align-items-center gap-2">
            <button type="button" class="d-block btn btn-success" id="isLoggedIn">Iniciar sesión</button>
            <div class="d-flex flex-column flex-lg-row align-items-center gap-4" id="isNotLoggedIn">
              <a class="d-flex align-items-center gap-2 nav-link w-100" href="#">
                <i class="fas fa-bell"></i>
                <span class="fs-6 d-lg-none">Notificaciones</span>
              </a>
              <a class="d-flex align-items-center gap-2 nav-link w-100" href="/pages/tienda.html">
                <i class="fas fa-dollar-sign"></i>
                <span class="fs-6 d-lg-none">Tienda</span>
              </a>
              <div class="nav-item dropdown d-none d-lg-block">
                <a class="nav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="fas fa-user"></i>
                </a>
                <ul class="dropdown-menu dropdown-menu-end shadow-lg mt-3">
                  <li><a class="dropdown-item" href="#">Perfil</a></li>
                  <li><a class="dropdown-item" href="#" id="closeSesionDesktop">Cerrar sesión</a></li>
                </ul>
              </div>
              <div class="d-flex flex-column gap-3 d-lg-none w-100">
                <a class="nav-link" href="#">
                  <i class="fas fa-user"></i>
                  <span class="fs-6">Perfil</span>
                </a>
                <button type="button" class="btn btn-sm btn-danger mb-2" id="closeSesionMobile">Cerrar sesión</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>
    <script src="../../js/header.js"></script>
  </header>

  <main class="container">
    <h1 class="text-center color-green fs-2 fw-bold my-4">Registro de actividades diarias</h1>

    <form class="form-container">
      <div class="form-section">
        <h2 class="fs-3 text-center">1. Transporte</h2>
        <p class="fs-6">1. ¿Qué medio de transporte usaste hoy? (Selecciona todas las que utilizaste)</p>
        <div class="checkbox-group">
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="auto">
            Auto propio
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="moto">
            Moto
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="public">
            Transporte público
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="bike">
            Bicicleta
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="walk">
            A pie
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" name="transport" type="checkbox" value="plane">
            Avión
          </label>
        </div>
      </div>
      <div class="form-section">
        <label for="distance" class="fs-6 mb-4">Si usaste auto o moto, introduce la distancia total recorrida (en km):</label>
        <div class="input-group d-flex align-items-center gap-3">
          <i class="fa-solid fa-car fs-1"></i>
          <input type="number" id="distance" class="form-control" placeholder="Distancia en km">
        </div>
      </div>
      <div class="form-section">
        <h2 class="font-subtitle-lg text-center">Tipo de combustible de tu vehículo:</h2>
        <div class="checkbox-group">
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" type="radio" value="gasoline" name="fuel">
            Gasolina
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" type="radio" value="diesel" name="fuel">
            Diésel
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" type="radio" value="electric" name="fuel">
            Eléctrico
          </label>
          <label class="fs-6 d-flex align-items-center gap-2">
            <input class="form-check-input" type="radio" value="hybrid" name="fuel">
            Híbrido
          </label>
        </div>
      </div>
      <div class="form-section">
        <label for="fuelConsumption" class="fs-6 mb-4">Consumo de combustible de tu vehículo (en L/100 km):</label>
        <div class="input-group d-flex align-items-center gap-3">
          <i class="fa-solid fa-gas-pump fs-1"></i>
          <input type="number" id="fuelConsumption" name="fuelConsumption" class="form-control" placeholder="Litros por 100 km">
        </div>
      </div>
      <div class="form-section">
        <label for="flightDistance" class="fs-6 mb-4">Si viajaste en avión, ¿cuántos kilómetros volaste?:</label>
        <div class="input-group d-flex align-items-center gap-3">
          <i class="fa-solid fa-plane fs-1"></i>
          <input type="number" id="flightDistance" name="flightDistance" class="form-control" placeholder="Kilómetros volados">
        </div>
      </div>
      <div class="submit-button">
        <button type="submit">
          <i class="fa-solid fa-arrow-right"></i>
        </button>
      </div>
    </form>
  </main>

  <script>
    document.querySelector('.form-container').addEventListener('submit', function (event) {
      event.preventDefault(); // Prevenir el envío del formulario por defecto
  
      // Obtener los valores de los campos
      const transportSelected = document.querySelectorAll('input[name="transport"]:checked');
      const distance = document.getElementById('distance').value;
      const fuelSelected = document.querySelector('input[name="fuel"]:checked'); // Radio button
      const fuelConsumption = document.getElementById('fuelConsumption').value;
      const flightDistance = document.getElementById('flightDistance').value;
  
      // Validaciones
      if (transportSelected.length === 0) {
        // alert('Por favor, selecciona al menos un medio de transporte.');
        Swal.fire({
          position: "top-end",
          icon: "error",
          title: "Por favor, selecciona al menos un medio de transporte.",
          showConfirmButton: false,
          timer: 1500
        });
        return;
      }
  
      if ((distance === '' || distance <= 0) && hasSelectedTransport(['auto', 'moto'])) {
        // alert('Si seleccionaste auto o moto, por favor introduce la distancia total recorrida.');
        Swal.fire({
          position: "top-end",
          icon: "error",
          title: "Si seleccionaste auto o moto, por favor introduce la distancia total recorrida.",
          showConfirmButton: false,
          timer: 1500
        });
        return;
      }
  
      if (!fuelSelected && hasSelectedTransport(['auto', 'moto'])) {
        // alert('Por favor, selecciona el tipo de combustible de tu vehículo.');
        Swal.fire({
          position: "top-end",
          icon: "error",
          title: "Por favor, selecciona el tipo de combustible de tu vehículo.",
          showConfirmButton: false,
          timer: 1500
        });
        return;
      }
  
      if ((fuelConsumption === '' || fuelConsumption <= 0) && hasSelectedTransport(['auto', 'moto'])) {
        // alert('Si seleccionaste auto o moto, por favor introduce el consumo de combustible de tu vehículo.');
        Swal.fire({
          position: "top-end",
          icon: "error",
          title: "Si seleccionaste auto o moto, por favor introduce el consumo de combustible de tu vehículo.",
          showConfirmButton: false,
          timer: 1500
        });
        return;
      }
  
      if (flightDistance === '' || flightDistance < 0) {
        // alert('Por favor, introduce los kilómetros volados o déjalo en 0 si no viajaste en avión.');
        Swal.fire({
          position: "top-end",
          icon: "error",
          title: "Por favor, introduce los kilómetros volados o déjalo en 0 si no viajaste en avión.",
          showConfirmButton: false,
          timer: 1500
        });
        return;
      }
  
      // Si todas las validaciones pasan, procesar los datos
      const data = {
        transport: Array.from(transportSelected).map(input => input.value),
        distance: distance || 0,
        fuelType: fuelSelected ? fuelSelected.value : null,
        fuelConsumption: fuelConsumption || 0,
        flightDistance: flightDistance || 0,
      };
  
      // console.log('Datos enviados:', data);
  
      // Redirigir a otra página después del envío
      // alert('Formulario enviado correctamente.');
      Swal.fire({
        position: "top-end",
        icon: "success",
        title: "Formulario enviado correctamente.",
        showConfirmButton: false,
        timer: 1500
      }).finally(() => {
        window.location.href = '/pages/flujo/registro-de-actividades-diarias-energia.html';
      });
      // window.location.href = '/gracias'; // Cambia la ruta según tus necesidades
    });
  
    // Función para comprobar si se seleccionó auto o moto
    function hasSelectedTransport(types) {
      const transportSelected = Array.from(document.querySelectorAll('input[name="transport"]:checked')).map(
        input => input.value
      );
      return types.some(type => transportSelected.includes(type));
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/js/all.min.js" integrity="sha512-6sSYJqDreZRZGkJ3b+YfdhB3MzmuP9R7X1QZ6g5aIXhRvR1Y/N/P47jmnkENm7YL3oqsmI6AK+V6AD99uWDnIw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>

</html>

